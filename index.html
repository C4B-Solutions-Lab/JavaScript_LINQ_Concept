<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8" />
  <meta name="description" content="JavaScript LINQ Concept by C4B Solutions Lab | Łukasz Dąbrowski - Inżynier Oprogramowania | Lukasz Dabrowski - Software Engineer" />
  <title>JLC 1.0 by Solutions Lab</title>
  <script src="js/jlc.js"></script>
  <script src="js/user-defined-functions.js"></script>
  <link href="css/css_jlc.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.css" rel="stylesheet" integrity="sha256-DVK12s61Wqwmj3XI0zZ9MFFmnNH8puF/eRHTB4ftKwk=" crossorigin="anonymous" />
 </head>
 <body>
	<div class="content">
		<div id="readme">
			Clear the cache . Open the console . Hit Ctrl+R
		</div>
		<div id="devtool-status"><i class="far fa-caret-square-right"></i></div>
		<div class="author"></div>
	</div>

	<script>
		var coll_1 = [
			{id: 1, name : "Object 1", ne : {ne_id : 1, ne_name : "NO 1"}, valid : true, lite : false, descr : "Descr 1", quality : "A"},
			{id: 2, name : "Object 2", ne : {ne_id : 2, ne_name : "NO 2"}, valid : true, lite : false, descr : "Descr 2", quality : "A"},
			{id: 3, name : "Object 3", ne: null, 						   valid : false, lite : false, descr: "Descr 3", quality: "C" },
			{id: 4, name : "Object 4", ne : {ne_id : 4, ne_name : "NO 4"}, valid : true, lite : false, descr : "Descr 4", quality : "B"},
			{id: 5, name : "Object 5", ne : {ne_id : 5, ne_name : "NO 5"}, valid : true, lite : false, descr : "Descr 5", quality : "A"},
			{id: 6, name : "Object 6", ne : {ne_id : 6, ne_name : "NO 6"}, valid : true, lite : true, descr : "Descr 6", quality : "C"},
			{id: 7, name : "Object 7", ne : {ne_id : 7, ne_name : "NO 7"}, valid : true, lite : false, descr : "Descr 7", quality : "D"},
			{id: 8, name : "Object 8", ne : {ne_id : 8, ne_name : "NO 8"}, valid : true, lite : false, descr : "Descr 8", quality : "E"},
			{id: 9, name : "Object 9", ne : {ne_id : 9, ne_name : "NO 9"}, valid : true, lite : true, descr : "Descr 9", quality : "F"},
			{id: 10, name : "Object 4", ne : {ne_id : 10, ne_name : "NO 10"}, valid : true, lite : true, descr : "Descr 4", quality : "A"}

		];
	
		var coll_primitives = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];

		debugger;


		/*

		// test availability of the query debugger () enabling execution of conditional JavaScript code (almost like in C#)
		var example_of_query_debugger = coll_1.usingLinq().reverse();


		// in case it doesn't work, try using stepping into with F11 and waiting a few seconds. After all, this is just for pure debugging purposes !!!! 😀😉
		var isDebugMode = example_of_query_debugger.ifConsoleDebug();
		if(isDebugMode) {
			console.log("Conditional code execution is available !");
			var debug_data = example_of_query_debugger.debugResultsView();

			console.log(debug_data);
		}
		else
			console.log("Conditional code execution is not available.\r\nPlease open the console to enable execution of conditional JavaScript code !");

		*/







		/**
		 * The following methods work the same way:
		 *  - methods not returning single value - primitive or a complex one - process not physical but logical data (action metadata about how to process physical data)
		 *  - methods returning single value - primitive or a complex one - are the only methods processing physical data
		 *  - methods returning data collections are the only following methods processing physical data
		 * 		-> toArray(context)
		 * 		-> toDictionary(..., context)
		 * 
		 * Context (to properly locate which actions should be execute in the action chain, are defined manually right now. They will be defined via JLC API)
		 * 
		 * Creating partial query not ended with toArray, toDictionary, or any method returning single value have no access to partial filtered data !!!!
		 * The goal is to enable something like ResultsView in C# while debugging LINQ query !
		 * This will be achieved via proudly called JLC 1.0 Query Debugger little mechanism !
		*/


		/**
		 * Some methods DO NOT produce immediate results !
		 * Intermediate results via property called 'resultsView' WILL ONLY BE available WHILE DEBUGGING !
		 *
		 * 			Example:
		 *  
		 * 			var where = coll_1.usingLinq()
		 *							  .where(...);
		 *
		 * 
		 * 	The list of these methods is :
		 * 		-  reverse
		 * 		-  take
		 * 		-  takeWhile
		 * 		-  skip
		 * 		-  skipWhile
		 * 
		*/


		/**
		 * Some methods DO produce immediate results !
		 *
		 * 			Example:
		 *  
		 * 			var where = coll_1.usingLinq()
		 *							  .toArray();
		 *
		 * 
		 * 	The list of these methods is :
		 * 		-  toArray
		 * 		-  toDictionary
		 * 		-  first
		 * 		-  firstOrDefault
		 * 		-  last
		 * 		-  lastOrDefault
		 * 		-  single
		 * 		-  singleOrDefault
		 * 		-  any
		 * 		-  all
		 * 
		*/

		

		/**
		 * Exemplary usage !
		*/

		/**
		 * Support for primitives added (tested in the following used methods) 😀😉
		 * 
		 * ⚠️
		 * 📢 - when dealing with array of primitive values, predicateArray array filters use a bit of new logic in comparison to array of objects :
		 * 		["_", ">=", 2, true]
		 * 		Given such a filter, the first field is a 'special' character called underscore '_' that tells that you deal with primitive value and not an object !
		 * 		Actually, the filter's first field can be provided in any of the following forms :
		 * 			'_' 	     (underscore)
		 * 			'    '       (any number of empty spaces, which are converted to 0-length string)
		 *          ''	         (0-length string) 
		*/  
		var nonEmpty_array = coll_primitives.usingLinq().any();

		var all_primitives = coll_primitives.usingLinq().all(		
																	{									
																		'predicateArray' :	[
																								["_", ">=", 2, true],
																								["", ">=", 4, true],
																								["           ", "<", 10, true]
																							]
																	}
															);


		var example_primitives_1 = coll_primitives.usingLinq()
												  .where(
																{
																	'predicateArray' :	[
																							["_", ">=", 2, true],
																							["_", "<", 10, true]
																						]
																}
														)
												  .take(
															{
																'count' : 6
															}
													   )
												  .lastOrDefault(
																	{									
																		'predicateArray' :	[
																								["_", ">", 5],
																								["_", "<", 7]
																							]
																	}
																);

		var example_primitives_2 = coll_primitives.usingLinq()
												  .where(
															{
																'predicateArray' :	[
																						["_", ">=", 2, true],
																						["_", "<", 10, true]
																					]
															}
														)
												  .takeWhile(
																{
																	'predicateArray' :	[
																							["_", ">", 0]
																						]
																}
															)
												  .skipWhile(
																{
																	'predicateArray' :	[
																							["_", "<", 6]
																						]
																}
															)
												  .toArray();



		var example_where = coll_1.usingLinq()
							  	  .where(
								  		  {									
												'predicateArray' :	[
																		["id", ">=", 2, true],
																		["ne.ne_id", "<", 10, true]
																	]
										  }
										);

		var example_where_groupBy = example_where.groupBy(
															{
																'predicateArray' :	[
																						["id", true],
																						[" - ", false],
																						["descr", true]
																					]
															}
														 );
		var example_where_groupBy_array = example_where_groupBy.toArray();
		var example_where_groupBy_array_2 = example_where.groupBy(
																	{
																		'predicateArray' :	[
																								["id", true],
																								[" - ", false],
																								["descr", true]
																							]
																	}
																  )
														 .toArray();

		var example_where_take_5 = example_where.take(
														{											
															'count' : 5
														}
													 );

		var example_where_skip_3 = example_where.skip(
														{
															'count' : 3
														}
											 		 );

		var example_where_take_2 = example_where.take(
														{
															'count' : 2
														}
											 		 );
		var example_where_take_2_skip_3 = example_where_take_2.skip(
																		{
																			'count' : 3
																		}
											 		 	   		   );




		var example_where_array = example_where.toArray();

		var example_where_take_5_array = example_where_take_5.toArray();		
		var example_where_take_5_first_or_default = example_where_take_5.firstOrDefault(
																							{									
																								'predicateArray' :	[
																														["id", ">", 1234567890]
																													]
																							}
																	   		   		   );
		var example_where_take_5_last = example_where_take_5.last();
		var example_where_take_5_last_or_default = example_where_take_5.lastOrDefault(
																							{									
																								'predicateArray' :	[
																														["id", ">", 7],
																														["id", "<", 9]
																													]
																							}
																					 );
		var example_where_take_5_last_or_default_2 = example_where_take_5.lastOrDefault(
																							{									
																								'predicateArray' :	[
																														["id", ">", 5],
																														["id", "<", 7]
																													]
																							}
																					 );

		// running whole query at once rather than breaking it into partial ones
		var example_where_take_5_last_or_default_3 = coll_1.usingLinq()
														   .where(
																	{									
																			'predicateArray' :	[
																									["id", ">=", 2, true],
																									["ne.ne_id", "<", 10, true]
																								]
																	}
																 )
														   .take(
																	{											
																		'count' : 5
																	}
																)
														   .lastOrDefault(
																			{									
																				'predicateArray' :	[
																										["id", ">", 5],
																										["id", "<", 7]
																									]
																			}
																		 );																 


		var example_where_skip_3_array = example_where_skip_3.toArray();
		var example_where_skip_3_dictionary = example_where_skip_3.toDictionary(
																					{
																						'predicateArray' :	[
																												["id", true],
																												[" - ", false],
																												["quality", true]
																											]
																					}
																			   );
		var example_where_skip_3_dictionary_arrayList = example_where_skip_3.toDictionary(
																							{
																								'predicateArray' :	[
																														["id", true],
																														[" - ", false],
																														["quality", true]
																													]
																							}
																			   			 )
																  			.toArrayList();
		var example_where_skip_3_groupBy = example_where_skip_3.groupBy(
																			{
																				'predicateArray' :	[
																										["id", true],
																										[" - ", false],
																										["quality", true]
																									]
																			}
																	   )
															   .toArray();

		var example_where_skip_3_groupBy_3 = coll_1.usingLinq()
												   .groupBy(
																{
																	'predicateArray' :	[
																							["name", true]
																						]
																}
														   )
												   .toArray();							   



		var example_take_2_skip_array = example_where_take_2_skip_3.toArray();
		

		var example_where_skip_3_usingLinq_where = example_where_skip_3.toArray()
																	    /**
																		 * Enable Linq after producing final result with invocation of toArray()
																		 * 
																		 * Guess why it's the natural and logical way of enabling continuation of Linq in JavaScript 
																		*/
																	   .usingLinq()
																	   .where(
																					{									
																							'predicateArray' :	[
																													["id", ">=", 2, true],
																													["ne.ne_id", "<", 10, true]
																												]
																					}
																			)
																	   .toArray();

		// when you're done with all querying, you can free some memory up by removing all data stored in _DATA object
		System.Linq.Resources.dispose();

	</script>
 </body>
</html>